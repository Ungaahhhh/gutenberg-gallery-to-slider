/*! v0.0.31 | Ungaahhhh | https://github.com/Ungaahhhh/gutenberg-gallery-to-slider/blob/main/LICENSE */
export class GGToSlider{constructor(option){if(this.init(option),this.storage.target&&this.storage.target.length>0)for(let i=0;i<this.storage.target.length;i++){let targetItem=this.storage.target.item(i);if(targetItem){targetItem.outerHTML=`<div class="GGToSlider"><div class="GGToSlider_inner">${targetItem.outerHTML}</div></div>`,this.init(),targetItem=this.storage.target.item(i),this.storage.gallery[i]=this.getSelectorAll(this.storage.scope,".GGToSlider").item(i);const gallery=this.storage.gallery[i];if(targetItem&&gallery){this.option.effect&&gallery.classList.add(this.option.effect);const inner=this.getSelector(this.storage.gallery[i],".GGToSlider_inner");if(targetItem.classList.add("GGToSlider_target"),this.storage.itemCount=targetItem.childElementCount,this.option.control&&"dot"===this.option.control.thumb){const ggToSliderThumbTemp=this.getTemp(this.storage.temp,"GGToSlider_thumb_temp"),ggToSliderThumb=this.getSelector(ggToSliderThumbTemp,".GGToSlider_thumb");ggToSliderThumb.classList.add(this.option.control.thumb);for(let j=0;j<this.storage.itemCount;j++){targetItem.children[j].classList.add("GGToSlider_target_item");const ggToSliderThumbItemTemp=this.getTemp(this.storage.temp,"GGToSlider_thumb_item_temp"),ggToSliderThumbItem=this.getSelector(ggToSliderThumbItemTemp,".GGToSlider_thumb_item");ggToSliderThumb.appendChild(ggToSliderThumbItem),ggToSliderThumbItem.addEventListener("click",(e=>{ggToSliderThumb.classList.add("disabled"),this.setIndex(i,j,"order")}))}inner.appendChild(ggToSliderThumb),this.storage.thumbItem=this.getSelectorAll(this.storage.gallery[i],".GGToSlider_thumb_item")}else if(this.option.control&&"image"===this.option.control.thumb){const ggToSliderThumbTemp=this.getTemp(this.storage.temp,"GGToSlider_thumb_temp"),ggToSliderThumb=this.getSelector(ggToSliderThumbTemp,".GGToSlider_thumb");ggToSliderThumb.classList.add(this.option.control.thumb);for(let j=0;j<this.storage.itemCount;j++){const image=targetItem.children[j];image.classList.add("GGToSlider_target_item");const ggToSliderThumbItemTemp=this.getTemp(this.storage.temp,"GGToSlider_thumb_item_temp"),ggToSliderThumbItem=this.getSelector(ggToSliderThumbItemTemp,".GGToSlider_thumb_item"),ggToSliderThumbImgTemp=this.getTemp(this.storage.temp,"GGToSlider_thumb_img_temp"),img=this.getSelector(ggToSliderThumbImgTemp,"img");img.src=this.getSelector(image,"img").src,ggToSliderThumbItem.appendChild(img),ggToSliderThumb.appendChild(ggToSliderThumbItem),ggToSliderThumbItem.addEventListener("click",(e=>{ggToSliderThumb.classList.add("disabled"),this.setIndex(i,j,"order")}))}if(gallery.appendChild(ggToSliderThumb),this.storage.thumbItem=this.getSelectorAll(gallery,".GGToSlider_thumb_item"),!0===this.option.control.adjacent){const ggToSliderControlTemp=this.getTemp(this.storage.temp,"GGToSlider_control_temp"),prev=this.getSelector(ggToSliderControlTemp,".prev"),next=this.getSelector(ggToSliderControlTemp,".next");prev.dataset.targetIndex=String(i),next.dataset.targetIndex=String(i),prev.addEventListener("click",(e=>{prev.classList.add("disabled"),this.setIndex(i,-1)})),next.addEventListener("click",(e=>{next.classList.add("disabled"),this.setIndex(i,1)})),inner.appendChild(ggToSliderControlTemp)}}if("fade"===this.option.effect)for(let j=0;j<this.storage.itemCount;j++){const element=targetItem.children[j];0===j&&element.classList.add("current"),element.addEventListener("animationend",(e=>{const target=e.target;if(target.classList.contains("fadeOut")&&target.classList.remove("fadeOut"),target.classList.contains("current")&&target.classList.remove("current"),target.classList.contains("fadeIn")&&(target.classList.remove("fadeIn"),target.classList.add("current")),this.option.control&&!0===this.option.control.adjacent){const prev=this.getSelector(inner,".prev"),next=this.getSelector(inner,".next");prev.classList.remove("disabled"),next.classList.remove("disabled")}this.getSelector(gallery,".GGToSlider_thumb").classList.remove("disabled")}))}this.setIndex(i,0,"order"),this.option.interval&&this.option.interval>0&&(this.setInterval(),gallery.addEventListener("mouseenter",(()=>{this.abortInterval()})),gallery.addEventListener("mouseleave",(()=>{this.setInterval()})))}}}}option={control:{adjacent:!0,thumb:"image"},effect:"slider",interval:0,scope:"",target:""};storage={current:0,gallery:[],interval:0,isEffectFirst:!0,itemCount:0,scope:null,target:null,temp:null,thumbItem:null};init=option=>{option&&(this.option={...this.option,...option}),this.storage.temp=this.getTemp(document,"GGToSlider_temp"),this.storage.scope=this.getSelector(document,this.option.scope),this.storage.target=this.getSelectorAll(this.storage.scope,this.option.target);try{if(!(this.storage.target&&this.storage.target.length>0))throw new Error}catch(error){console.log(`${this.option.scope} or ${this.option.target} が取得できませんでした。`)}};getTemp=(parent,id)=>parent.getElementById(id).content.cloneNode(!0);getSelector=(parent,query)=>parent.querySelector(query);getSelectorAll=(parent,query)=>parent.querySelectorAll(query);setIndex=(targetIndex,num,mode)=>{const last=this.storage.current;if(this.storage.target){const targetItem=this.storage.target[targetIndex],galleryItem=this.storage.gallery[targetIndex];if(mode)switch(mode){case"reverse":this.storage.current-=num;break;case"order":this.storage.current=num;break;default:this.storage.current+=num}else this.storage.current+=num;switch(this.storage.current>=this.storage.itemCount?this.storage.current=0:this.storage.current<0&&(this.storage.current=this.storage.itemCount-1),this.option.effect){case"fade":this.storage.isEffectFirst||(targetItem.children[last].classList.remove("fadeIn"),targetItem.children[last].classList.add("fadeOut"),targetItem.children[this.storage.current].classList.remove("fadeOut"),targetItem.children[this.storage.current].classList.add("fadeIn")),this.storage.isEffectFirst=!1;break;case"slider":targetItem.scrollLeft=targetItem.offsetWidth*this.storage.current,setTimeout((()=>{if(this.option.control&&!0===this.option.control.adjacent){const prev=this.getSelector(galleryItem,".prev"),next=this.getSelector(galleryItem,".next");prev.classList.remove("disabled"),next.classList.remove("disabled")}const ggToSliderThumb=this.getSelector(galleryItem,".GGToSlider_thumb");ggToSliderThumb&&ggToSliderThumb.classList.remove("disabled")}),400)}if(this.storage.thumbItem){for(let i=0;i<this.storage.thumbItem.length;i++){const prev=this.storage.thumbItem.item(i);prev&&prev.classList.remove("active")}const next=this.storage.thumbItem.item(this.storage.current);next&&next.classList.add("active")}}};setInterval=()=>{this.storage.interval=window.setInterval((()=>{if(this.storage.target&&this.storage.target.length>0)for(let i=0;i<this.storage.target.length;i++)this.setIndex(i,1)}),this.option.interval)};abortInterval=()=>{clearInterval(this.storage.interval)}}